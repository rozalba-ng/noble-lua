--[[Каждые 5 минут проверяет челочисленный]]

local function sendVoteLetters()
	local bonusQuery = CharDBQuery("SELECT * from doors_owners where bonus > 0");
	if (bonusQuery ~= nil) then
		local rowCount = bonusQuery:GetRowCount();	
		local entry;
		for var=1,rowCount,1 do
			local ownerData = bonusQuery:GetRow();
			local door_guid = ownerData['door_guid'];
			local amount = math.floor(ownerData['bonus']);
			local playerId = ownerData['ownerID'];
			
			if (playerId ~= 0 and amount > 0) then
				SendMail('Bank Barclays', 'Hello! Here is your income for the house number ' .. door_guid .. '. Greetings, bank Barclays', playerId, 36, 61, 20, 0, 0, 43721, amount);
				CharDBQuery('UPDATE doors_owners set bonus = bonus - ' .. amount .. ' where door_guid = ' .. door_guid);
			end
			bonusQuery:NextRow();
		end
	end	
end

CreateLuaEvent(sendVoteLetters, 60000, 0);